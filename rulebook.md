# burgerwar ルール
※基本的なルールは決定しましたが、
検証状況に応じて、障害物の配置やポイント配分などを当日までに微調整をする場合があります。
変更があった場合は、なるべく早くお知らせいたします。

## 概要

「burger war」は、ロボットを自律移動させ、１対１で撃ち合うゲームです。

主砲の代わりに、正面のカメラでターゲット(ARマーカー)を読み取ります.

ターゲットから読み取ったIDを審判サーバーに提出すると、その的を撃ち落としたという扱いになります。

ターゲットはフィールドと機体に取り付けられています。フィールドのターゲットは固定されているので容易に撃てる反面ポイントは少なく、機体のターゲットは撃つのが難しかわりに高得点です。
相手を狙うのか、フィールドのターゲットを多く狙うのかどのような戦略で行動するかが重要になります。

ロボットは完全自律とし、スタート後は手動操作を禁止します。

## フィールド
フィールド及びターゲットの寸法などの図は本リポジトリの[burger_war_field.pdf](/doc/burger_war_field.pdf)を参照ください。

- **2.4m**四方の壁で囲われたフィールド内で競技を行う。
- 競技フィールド内には、障害物を設置する。
- **障害物**は、常に同じ位置に初期設置する。
- **障害物**は、動かないように床面に固定して設置している。
- **障害物**が動いた場合も試合は続行する。
- **フィールドの壁**は、ロボットで押しても動かないように固定する。
- **床面**は会場の板張りの床をそのまま使用する。

## ターゲット
ターゲットは**直径80mm**の円形、中心にARマーカーを印刷している。

機体に取り付けるターゲットと、フィールどに設置されたターゲットがあり、機体のターゲットは緑、フィールドのターゲットは青色をしている。

**機体のターゲット**は、上の画像のように左右１枚づつ、背後１枚の計**3枚**。**フィールドのターゲット**は点対称に**12枚**設置する。


## 勝敗の決定方法
ターゲットから読み取ったIDを審判サーバーに提出すると、そのターゲットを撃ち抜いたと扱う。
ターゲットを撃ち抜くと、ポイントを獲得できる。

**フィールドターゲットは最後に獲得したチームのポイントとなる。** １度獲得しても相手に取り返された場合、相手のポイントとなる。制限時間内ならば、何度でも取り返す事ができる。

**相手背後のターゲットは、撃ち抜いた瞬間に勝利確定（1本勝ち）とする。**

**配点**
- 相手背後   ： 勝利確定
- 相手左右   ： 5ポイント
- フィールド ：１ポイント

**制限時間３分間**以内に１本勝ち、または終了時にポイントが多いチームの勝利とする。

制限時間終了時、両チーム同点の場合は、**1分間のサドンデス**に突入する。サドンデスでは先に１点でも得点したチームの勝利とする。
サドンデスでも決着がつかなかった場合は、チームの代表者によるじゃんけんで勝敗を決める。

## リトライ
審判は、試合開始時のトラブルによりマシンが動作していないと判断した場合、リトライ宣言によって試合を中断し、はじめからやり直しを命じることができる。
本ルールは、トラブルによりマシンが全く動かない場合や初期化のミスなどへの救済措置である。


## 開始シーケンス
### 実機の場合
開始地点にロボットをセットした状態を、開始待ち状態とする。開始地点はスタートエリア中心でロボットの向きはフィールど中央とする。
開始前に `setup.launch` を起動しカメラやLidar、turtlebot３のノードを立ち上げる。
その後、試合開始と同時に `your_burger.launch` を起動する。
ロボットを動作させるノードをこのlaunchファイルで立ち上がるようにプログラムを作成してください。
`setup.launch` の内容は変更を加えないでください。

### シミュレータの場合
開始前に `setup_sim.launch` を起動しシミュレータを起動し、完全に起動したことを確認後、試合開始と同時に `your_burger.launch` を起動する。
ロボットを動作させるノードをこのlaunchファイルで立ち上がるようにプログラムを作成してください。
`setup_sim.launch` の内容は変更を加えないでください。

## ロボット
ロボットはturtlebot3 burger を使用する。
ロボットの詳細情報は[burger_spec.pdf](/doc/burger_spec.pdf)を参照とする。
ロボットは運営が準備したものを使用し、改造は禁止とする。

## その他
機体に著しい負担がかかり故障や事故が予想されるなど、審判が危険と判断した場合は試合を中断し、負けとする場合がある（レフェリーストップ）。

競技者が競技中にコース内に入ることは認めない。また、意図的にロボットのセンサに作用するような行動で、誤動作を誘発させたり、意図的な操作を行うことを禁止する。

審判の判断で悪質なチート行為があったと判断した場合は、警告したうえで再試合または、該当チームを失格とすることができる。

